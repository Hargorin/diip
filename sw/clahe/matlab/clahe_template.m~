%% Template to plot the data from the CLAHE

clc; clear all; close all;


% Data
fid = fopen('test.txt');

h_orig = fgetl(fid);
h_clip = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 8 34 88 183 259 314 405 563 682 944 1238 1608 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1672 1580 1368 1390 1238 1111 958 895 890 774 697 666 568 555 472 429 361 299 257 241 220 185 185 154 151 182 206 224 209 235 228 231 227 214 223 219 204 271 343 306 183 43 7 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ];
h_dist = [130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 138 164 218 313 389 444 535 693 812 1074 1368 1738 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1710 1498 1520 1368 1241 1088 1025 1020 904 827 796 698 685 602 559 491 429 387 371 350 315 315 284 281 312 336 354 339 365 358 361 357 344 353 349 334 401 473 436 313 173 137 131 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 130 ];
h_redist = [147 147 147 147 147 147 147 147 147 147 147 147 147 147 147 147 147 147 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 154 180 234 329 405 460 551 709 828 1090 1384 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1752 1726 1514 1536 1384 1257 1104 1041 1036 920 843 812 714 701 618 575 507 445 403 387 366 331 331 300 297 328 352 370 355 381 374 377 373 360 369 365 350 417 489 452 329 189 153 147 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 146 ];
h_cdf = [0.35 0.71 1.06 1.41 1.77 2.12 2.47 2.83 3.18 3.53 3.89 4.24 4.59 4.95 5.30 5.65 6.01 6.36 6.71 7.06 7.41 7.77 8.12 8.47 8.82 9.17 9.52 9.87 10.22 10.57 10.92 11.28 11.63 11.98 12.33 12.68 13.03 13.38 13.73 14.08 14.43 14.79 15.14 15.49 15.84 16.19 16.54 16.89 17.24 17.59 17.95 18.30 18.65 19.00 19.35 19.70 20.05 20.40 20.75 21.10 21.46 21.81 22.16 22.51 22.86 23.21 23.56 23.91 24.26 24.61 24.97 25.32 25.67 26.02 26.37 26.72 27.07 27.42 27.77 28.12 28.48 28.83 29.18 29.53 29.88 30.23 30.58 30.93 31.28 31.63 31.99 32.34 32.69 33.04 33.39 33.74 34.09 34.44 34.79 35.14 35.50 35.85 36.20 36.55 36.90 37.25 37.60 37.95 38.30 38.65 39.01 39.36 39.71 40.06 40.41 40.76 41.11 41.46 41.81 42.18 42.62 43.18 43.97 44.94 46.05 47.37 49.08 51.07 53.69 57.02 61.23 65.44 69.65 73.87 78.08 82.29 86.50 90.72 94.93 99.14 103.35 107.56 111.78 115.99 120.20 124.41 128.63 132.84 137.05 141.26 145.47 149.69 153.90 158.11 162.32 166.53 170.75 174.96 179.11 182.75 186.44 189.77 192.79 195.45 197.95 200.44 202.65 204.68 206.63 208.35 210.03 211.52 212.90 214.12 215.19 216.16 217.09 217.97 218.76 219.56 220.28 220.99 221.78 222.63 223.52 224.37 225.29 226.19 227.09 227.99 228.86 229.74 230.62 231.46 232.47 233.64 234.73 235.52 235.97 236.34 236.69 237.05 237.40 237.75 238.10 238.45 238.80 239.15 239.50 239.85 240.20 240.56 240.91 241.26 241.61 241.96 242.31 242.66 243.01 243.36 243.71 244.07 244.42 244.77 245.12 245.47 245.82 246.17 246.52 246.87 247.22 247.58 247.93 248.28 248.63 248.98 249.33 249.68 250.03 250.38 250.73 251.09 251.44 251.79 252.14 252.49 252.84 253.19 253.54 253.89 254.24 254.60 254.95 255.30 255.65 256.00 ];
h_clahe = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 42 271 259 0 314 405 0 563 0 682 0 944 0 0 0 1238 0 0 0 1608 0 0 0 1977 0 0 0 2593 0 0 0 3108 0 0 0 0 3712 0 0 0 4248 0 0 0 4537 0 0 0 4501 0 0 0 4027 0 0 0 0 3753 0 0 0 3597 0 0 0 3220 0 0 0 3025 0 0 0 2959 0 0 0 0 2979 0 0 0 2865 0 0 0 2808 0 0 0 2858 0 0 0 0 2789 0 0 0 2834 0 0 0 2787 0 0 0 2758 0 0 0 2720 0 0 0 0 2473 0 0 0 2125 0 0 0 1888 0 0 0 1861 0 0 0 1672 0 0 0 0 1580 0 0 1368 0 0 0 1390 0 0 1238 0 0 1111 0 0 958 0 895 0 0 890 0 774 0 697 0 666 0 568 0 555 472 429 0 361 299 257 461 185 185 305 182 206 224 209 235 228 458 214 223 219 204 271 343 306 226 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ];

% Plot

% Distribution
figure();
subplot(2,2,1);
plot(h_orig);
title('Original Image');

subplot(2,2,2);
plot(h_clip);
title('Clipping');

subplot(2,2,3);
plot(h_dist);
title('Distribution');

subplot(2,2,4);
plot(h_redist);
title('Redistribution')

% Contrast enhancment
figure();
subplot(2,2,[1 2])
plot(h_cdf);
title('CDF')

subplot(2,2,3);
plot(h_orig);
title('Original Image')

subplot(2,2,4);
plot(h_clahe);
title('CLAHE Image')